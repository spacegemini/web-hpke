/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/hpke-js@1.6.5/esm/mod.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{CipherSuite as e,InvalidParamError as r,KemId as a,KdfId as t,ExportOnly as i,AeadId as n,Aes256Gcm as s,Aes128Gcm as h}from"./hpke_core.js";export{AeadId,DecapError,DeriveKeyPairError,DeserializeError,EncapError,ExportError,HpkeError,InvalidParamError,KdfId,KemId,MessageLimitReachedError,NotSupportedError,OpenError,SealError,SerializeError,ValidationError}from"./hpke_core.js";import{Chacha20Poly1305 as o}from"./hpke_chacha20poly1305.js";import{HkdfSha256 as c,DhkemX25519HkdfSha256 as m}from"./hpke_dhkem_x25519.js";import{HkdfSha512 as l,DhkemX448HkdfSha512 as b}from"./hpke_dhkem_x448.js";import{HkdfSha384Native as f,hmac as d,sha384 as k,Dhkem as u,Ec as p,KemId as w}from"./hpke_common.js";const y={NotAssigned:0,DhkemP256HkdfSha256:16,DhkemP384HkdfSha384:17,DhkemP521HkdfSha512:18,DhkemSecp256k1HkdfSha256:19,DhkemX25519HkdfSha256:32,DhkemX448HkdfSha512:33,HybridkemX25519Kyber768:48},S={HkdfSha256:1,HkdfSha384:2,HkdfSha512:3},P={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535};class H extends f{async extract(e,r){if(await this._setup(),0===e.byteLength&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)return d(k,new Uint8Array(e),new Uint8Array(r)).buffer;const a=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",a,r)}}class g extends u{constructor(){const e=new c,r=new p(w.DhkemP256HkdfSha256,e);super(w.DhkemP256HkdfSha256,r,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:w.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}}class D extends u{constructor(){const e=new H,r=new p(w.DhkemP384HkdfSha384,e);super(w.DhkemP384HkdfSha384,r,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:w.DhkemP384HkdfSha384}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:48})}}class v extends u{constructor(){const e=new l,r=new p(w.DhkemP521HkdfSha512,e);super(w.DhkemP521HkdfSha512,r,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:w.DhkemP521HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64})}}class K extends e{constructor(e){if("number"==typeof e.kem)switch(e.kem){case a.DhkemP256HkdfSha256:e.kem=new g;break;case a.DhkemP384HkdfSha384:e.kem=new D;break;case a.DhkemP521HkdfSha512:e.kem=new v;break;case a.DhkemX25519HkdfSha256:e.kem=new m;break;case a.DhkemX448HkdfSha512:e.kem=new b;break;default:throw new r(`The KEM (${e.kem}) cannot be specified by KemId. Use submodule for the KEM`)}if("number"==typeof e.kdf)switch(e.kdf){case t.HkdfSha256:e.kdf=new c;break;case t.HkdfSha384:e.kdf=new H;break;default:e.kdf=new l}if("number"==typeof e.aead)switch(e.aead){case n.Aes128Gcm:e.aead=new h;break;case n.Aes256Gcm:e.aead=new s;break;case n.Chacha20Poly1305:e.aead=new o;break;default:e.aead=new i}super(e)}async generateKeyPair(){return await this._setup(),await this._kem.generateKeyPair()}async deriveKeyPair(e){return await this._setup(),await this._kem.deriveKeyPair(e)}async importKey(e,r,a=!0){return await this._setup(),await this._kem.importKey(e,r,a)}}export{P as Aead,K as CipherSuite,S as Kdf,y as Kem};export default null;
//# sourceMappingURL=/sm/5fae43416e338a70d1ed650275c40039cf9aca86077a221d60af47d012f75761.map