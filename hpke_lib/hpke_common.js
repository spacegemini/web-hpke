/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/@hpke/common@1.8.1/esm/mod.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
class e extends Error{constructor(e){let t;t=e instanceof Error?e.message:"string"==typeof e?e:"",super(t),this.name=this.constructor.name}}class t extends e{}class i extends e{}class r extends e{}class n extends e{}class a extends e{}class s extends e{}class l extends e{}class c extends e{}class o extends e{}class h extends e{}class u extends e{}class b extends e{}const f=(d=globalThis,y={},new Proxy(d,{get:(e,t,i)=>t in y?y[t]:d[t],set:(e,t,i)=>(t in y&&delete y[t],d[t]=i,!0),deleteProperty(e,t){let i=!1;return t in y&&(delete y[t],i=!0),t in d&&(delete d[t],i=!0),i},ownKeys(e){const t=Reflect.ownKeys(d),i=Reflect.ownKeys(y),r=new Set(i);return[...t.filter((e=>!r.has(e))),...i]},defineProperty:(e,t,i)=>(t in y&&delete y[t],Reflect.defineProperty(d,t,i),!0),getOwnPropertyDescriptor:(e,t)=>t in y?Reflect.getOwnPropertyDescriptor(y,t):Reflect.getOwnPropertyDescriptor(d,t),has:(e,t)=>t in y||t in d}));var d,y;class w{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}async _setup(){void 0===this._api&&(this._api=await async function(){if(void 0!==f&&void 0!==globalThis.crypto)return globalThis.crypto.subtle;try{const{webcrypto:e}=await import("/npm/crypto/+esm");return e.subtle}catch(e){throw new b(e)}}())}}const p={Base:0,Psk:1,Auth:2,AuthPsk:3},g={NotAssigned:0,DhkemP256HkdfSha256:16,DhkemP384HkdfSha384:17,DhkemP521HkdfSha512:18,DhkemSecp256k1HkdfSha256:19,DhkemX25519HkdfSha256:32,DhkemX448HkdfSha512:33,HybridkemX25519Kyber768:48,MlKem512:64,MlKem768:65,MlKem1024:66,XWing:25722},m={HkdfSha256:1,HkdfSha384:2,HkdfSha512:3},v={Aes128Gcm:1,Aes256Gcm:2,Chacha20Poly1305:3,ExportOnly:65535},P=8192,_=65536,K=32,x=new Uint8Array(0),A=new Uint8Array([75,69,77,0,0]),k=()=>void 0===f.process;function j(){return void 0===f.process||void 0!==f.process?.versions?.deno}const O=e=>"object"==typeof e&&null!==e&&"object"==typeof e.privateKey&&"object"==typeof e.publicKey;function U(e,t){if(t<=0)throw new Error("i2Osp: too small size");if(e>=256**t)throw new Error("i2Osp: too large integer");const i=new Uint8Array(t);for(let r=0;r<t&&e;r++)i[t-(r+1)]=e%256,e>>=8;return i}function H(e,t){const i=new Uint8Array(e.length+t.length);return i.set(e,0),i.set(t,e.length),i}function z(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),i=atob(t),r=new Uint8Array(i.length);for(let e=0;e<i.length;e++)r[e]=i.charCodeAt(e);return r}function E(e){if(0===e.length)return new Uint8Array([]);const t=e.match(/[\da-f]{2}/gi);if(null==t)throw new Error("Not hex string.");return new Uint8Array(t.map((function(e){return parseInt(e,16)})))}function S(e){switch(e){case g.DhkemP256HkdfSha256:return{name:"ECDH",namedCurve:"P-256"};case g.DhkemP384HkdfSha384:return{name:"ECDH",namedCurve:"P-384"};case g.DhkemP521HkdfSha512:return{name:"ECDH",namedCurve:"P-521"};default:return{name:"X25519"}}}async function I(){if(void 0!==f&&void 0!==globalThis.crypto)return globalThis.crypto.subtle;try{const{webcrypto:e}=await import("/npm/crypto/+esm");return e.subtle}catch(e){throw new Error("Failed to load SubtleCrypto")}}async function L(){if(void 0!==f&&void 0!==globalThis.crypto)return globalThis.crypto;try{const{webcrypto:e}=await import("/npm/crypto/+esm");return e}catch(e){throw new Error("Web Cryptograph API not supported")}}function B(e,t){if(e.byteLength!==t.byteLength)throw new Error("xor: different length inputs");const i=new Uint8Array(e.byteLength);for(let r=0;r<e.byteLength;r++)i[r]=e[r]^t[r];return i}const C=new Uint8Array([101,97,101,95,112,114,107]),D=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]);class F{constructor(e,t,i){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=e,this._prim=t,this._kdf=i;const r=new Uint8Array(A);r.set(U(this.id,2),3),this._kdf.init(r)}async serializePublicKey(e){return await this._prim.serializePublicKey(e)}async deserializePublicKey(e){return await this._prim.deserializePublicKey(e)}async serializePrivateKey(e){return await this._prim.serializePrivateKey(e)}async deserializePrivateKey(e){return await this._prim.deserializePrivateKey(e)}async importKey(e,t,i=!0){return await this._prim.importKey(e,t,i)}async generateKeyPair(){return await this._prim.generateKeyPair()}async deriveKeyPair(e){if(e.byteLength>8192)throw new t("Too long ikm");return await this._prim.deriveKeyPair(e)}async encap(e){let t;t=void 0===e.ekm?await this.generateKeyPair():O(e.ekm)?e.ekm:await this.deriveKeyPair(e.ekm);const i=await this._prim.serializePublicKey(t.publicKey),r=await this._prim.serializePublicKey(e.recipientPublicKey);try{let n,a;if(void 0===e.senderKey)n=new Uint8Array(await this._prim.dh(t.privateKey,e.recipientPublicKey));else{const i=O(e.senderKey)?e.senderKey.privateKey:e.senderKey,r=new Uint8Array(await this._prim.dh(t.privateKey,e.recipientPublicKey));n=H(r,new Uint8Array(await this._prim.dh(i,e.recipientPublicKey)))}if(void 0===e.senderKey)a=H(new Uint8Array(i),new Uint8Array(r));else{const t=O(e.senderKey)?e.senderKey.publicKey:await this._prim.derivePublicKey(e.senderKey),n=await this._prim.serializePublicKey(t);a=function(e,t,i){const r=new Uint8Array(e.length+t.length+i.length);return r.set(e,0),r.set(t,e.length),r.set(i,e.length+t.length),r}(new Uint8Array(i),new Uint8Array(r),new Uint8Array(n))}return{enc:i,sharedSecret:await this._generateSharedSecret(n,a)}}catch(e){throw new a(e)}}async decap(e){const t=await this._prim.deserializePublicKey(e.enc),i=O(e.recipientKey)?e.recipientKey.privateKey:e.recipientKey,r=O(e.recipientKey)?e.recipientKey.publicKey:await this._prim.derivePublicKey(e.recipientKey),n=await this._prim.serializePublicKey(r);try{let r,a;if(void 0===e.senderPublicKey)r=new Uint8Array(await this._prim.dh(i,t));else{const n=new Uint8Array(await this._prim.dh(i,t));r=H(n,new Uint8Array(await this._prim.dh(i,e.senderPublicKey)))}if(void 0===e.senderPublicKey)a=H(new Uint8Array(e.enc),new Uint8Array(n));else{const t=await this._prim.serializePublicKey(e.senderPublicKey);a=new Uint8Array(e.enc.byteLength+n.byteLength+t.byteLength),a.set(new Uint8Array(e.enc),0),a.set(new Uint8Array(n),e.enc.byteLength),a.set(new Uint8Array(t),e.enc.byteLength+n.byteLength)}return await this._generateSharedSecret(r,a)}catch(e){throw new s(e)}}async _generateSharedSecret(e,t){const i=this._kdf.buildLabeledIkm(C,e),r=this._kdf.buildLabeledInfo(D,t,this.secretSize);return await this._kdf.extractAndExpand(x.buffer,i.buffer,r.buffer,this.secretSize)}}const G=["deriveBits"],T=new Uint8Array([100,107,112,95,112,114,107]),$=new Uint8Array([115,107]);class M{constructor(e){Object.defineProperty(this,"_num",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._num=new Uint8Array(e)}val(){return this._num}reset(){this._num.fill(0)}set(e){if(e.length!==this._num.length)throw new Error("Bignum.set: invalid argument");this._num.set(e)}isZero(){for(let e=0;e<this._num.length;e++)if(0!==this._num[e])return!1;return!0}lessThan(e){if(e.length!==this._num.length)throw new Error("Bignum.lessThan: invalid argument");for(let t=0;t<this._num.length;t++){if(this._num[t]<e[t])return!0;if(this._num[t]>e[t])return!1}return!1}}const N=new Uint8Array([99,97,110,100,105,100,97,116,101]),R=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),X=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),W=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]),V=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),J=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),Z=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);class q extends w{constructor(e,t){switch(super(),Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_alg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDh",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bitmask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pkcs8AlgId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,e){case g.DhkemP256HkdfSha256:this._alg={name:"ECDH",namedCurve:"P-256"},this._nPk=65,this._nSk=32,this._nDh=32,this._order=R,this._bitmask=255,this._pkcs8AlgId=V;break;case g.DhkemP384HkdfSha384:this._alg={name:"ECDH",namedCurve:"P-384"},this._nPk=97,this._nSk=48,this._nDh=48,this._order=X,this._bitmask=255,this._pkcs8AlgId=J;break;default:this._alg={name:"ECDH",namedCurve:"P-521"},this._nPk=133,this._nSk=66,this._nDh=66,this._order=W,this._bitmask=1,this._pkcs8AlgId=Z}}async serializePublicKey(e){await this._setup();try{return await this._api.exportKey("raw",e)}catch(e){throw new r(e)}}async deserializePublicKey(e){await this._setup();try{return await this._importRawKey(e,!0)}catch(e){throw new n(e)}}async serializePrivateKey(e){await this._setup();try{const t=await this._api.exportKey("jwk",e);if(!("d"in t))throw new Error("Not private key");return z(t.d).buffer}catch(e){throw new r(e)}}async deserializePrivateKey(e){await this._setup();try{return await this._importRawKey(e,!1)}catch(e){throw new n(e)}}async importKey(e,t,i){await this._setup();try{if("raw"===e)return await this._importRawKey(t,i);if(t instanceof ArrayBuffer)throw new Error("Invalid jwk key format");return await this._importJWK(t,i)}catch(e){throw new n(e)}}async generateKeyPair(){await this._setup();try{return await this._api.generateKey(this._alg,!0,G)}catch(e){throw new b(e)}}async deriveKeyPair(e){await this._setup();try{const t=await this._hkdf.labeledExtract(x.buffer,T,new Uint8Array(e)),i=new M(this._nSk);for(let e=0;i.isZero()||!i.lessThan(this._order);e++){if(e>255)throw new Error("Faild to derive a key pair");const r=new Uint8Array(await this._hkdf.labeledExpand(t,N,U(e,1),this._nSk));r[0]=r[0]&this._bitmask,i.set(r)}const r=await this._deserializePkcs8Key(i.val());return i.reset(),{privateKey:r,publicKey:await this.derivePublicKey(r)}}catch(e){throw new u(e)}}async derivePublicKey(e){await this._setup();try{const t=await this._api.exportKey("jwk",e);return delete t.d,delete t.key_ops,await this._api.importKey("jwk",t,this._alg,!0,[])}catch(e){throw new n(e)}}async dh(e,t){try{await this._setup();return await this._api.deriveBits({name:"ECDH",public:t},e,8*this._nDh)}catch(e){throw new r(e)}}async _importRawKey(e,t){if(t&&e.byteLength!==this._nPk)throw new Error("Invalid public key for the ciphersuite");if(!t&&e.byteLength!==this._nSk)throw new Error("Invalid private key for the ciphersuite");return t?await this._api.importKey("raw",e,this._alg,!0,[]):await this._deserializePkcs8Key(new Uint8Array(e))}async _importJWK(e,t){if(void 0===e.crv||e.crv!==this._alg.namedCurve)throw new Error(`Invalid crv: ${e.crv}`);if(t){if(void 0!==e.d)throw new Error("Invalid key: `d` should not be set");return await this._api.importKey("jwk",e,this._alg,!0,[])}if(void 0===e.d)throw new Error("Invalid key: `d` not found");return await this._api.importKey("jwk",e,this._alg,!0,G)}async _deserializePkcs8Key(e){const t=new Uint8Array(this._pkcs8AlgId.length+e.length);return t.set(this._pkcs8AlgId,0),t.set(e,this._pkcs8AlgId.length),await this._api.importKey("pkcs8",t,this._alg,!0,G)}}class Q{constructor(e,t,i,r=[]){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.key=t,this.type=i,this.algorithm={name:e},this.usages=r,"public"===i&&(this.usages=[])}}class Y{constructor(e,t,i,r){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:g.NotAssigned}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_a",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_b",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=e,this._a=t,this._b=i,this._kdf=r;const n=new Uint8Array(A);n.set(U(this.id,2),3),this._kdf.init(n)}async serializePublicKey(e){try{return await this._serializePublicKey(e)}catch(e){throw new r(e)}}async deserializePublicKey(e){try{return await this._deserializePublicKey(e)}catch(e){throw new n(e)}}async serializePrivateKey(e){try{return await this._serializePrivateKey(e)}catch(e){throw new r(e)}}async deserializePrivateKey(e){try{return await this._deserializePrivateKey(e)}catch(e){throw new n(e)}}async generateKeyPair(){const e=await this._a.generateKeyPair(),t=await this._b.generateKeyPair(),i=await this._a.serializePublicKey(e.publicKey),r=await this._a.serializePrivateKey(e.privateKey),n=await this._b.serializePublicKey(t.publicKey),a=await this._b.serializePrivateKey(t.privateKey);return{publicKey:await this.deserializePublicKey(H(new Uint8Array(i),new Uint8Array(n)).buffer),privateKey:await this.deserializePrivateKey(H(new Uint8Array(r),new Uint8Array(a)).buffer)}}async deriveKeyPair(e){const t=await this._kdf.labeledExtract(x.buffer,T,new Uint8Array(e)),i=new Uint8Array(await this._kdf.labeledExpand(t,$,x,96)),r=i.slice(0,32),n=i.slice(32,96),a=await this._a.deriveKeyPair(r.buffer),s=await this._b.deriveKeyPair(n.buffer),l=await this._a.serializePublicKey(a.publicKey),c=await this._a.serializePrivateKey(a.privateKey),o=await this._b.serializePublicKey(s.publicKey),h=await this._b.serializePrivateKey(s.privateKey);return{publicKey:await this.deserializePublicKey(H(new Uint8Array(l),new Uint8Array(o)).buffer),privateKey:await this.deserializePrivateKey(H(new Uint8Array(c),new Uint8Array(h)).buffer)}}async importKey(e,i,r=!0){if("raw"!==e)throw new b("'jwk' is not supported");if(!(i instanceof ArrayBuffer))throw new t("Invalid type of key");return r?await this.deserializePublicKey(i):await this.deserializePrivateKey(i)}async encap(e){let i,r;if(void 0!==e.ekm&&!O(e.ekm)){if(64!==e.ekm.byteLength)throw new t("ekm must be 64 bytes in length");i=e.ekm.slice(0,32),r=e.ekm.slice(32)}const n=new Uint8Array(await this.serializePublicKey(e.recipientPublicKey)),a=await this._a.deserializePublicKey(n.slice(0,this._a.publicKeySize).buffer),s=await this._b.deserializePublicKey(n.slice(this._a.publicKeySize).buffer),l=await this._a.encap({recipientPublicKey:a,ekm:i}),c=await this._b.encap({recipientPublicKey:s,ekm:r});return{sharedSecret:H(new Uint8Array(l.sharedSecret),new Uint8Array(c.sharedSecret)).buffer,enc:H(new Uint8Array(l.enc),new Uint8Array(c.enc)).buffer}}async decap(e){const t=O(e.recipientKey)?e.recipientKey.privateKey:e.recipientKey,i=new Uint8Array(await this.serializePrivateKey(t)),r=await this._a.deserializePrivateKey(i.slice(0,this._a.privateKeySize).buffer),n=await this._b.deserializePrivateKey(i.slice(this._a.privateKeySize).buffer),a=await this._a.decap({recipientKey:r,enc:e.enc.slice(0,this._a.encSize)}),s=await this._b.decap({recipientKey:n,enc:e.enc.slice(this._a.encSize)});return H(new Uint8Array(a),new Uint8Array(s)).buffer}_serializePublicKey(e){return new Promise(((t,i)=>{"public"!==e.type&&i(new Error("Not public key")),e.algorithm.name!==this.name&&i(new Error(`Invalid algorithm name: ${e.algorithm.name}`)),e.key.byteLength!==this.publicKeySize&&i(new Error(`Invalid key length: ${e.key.byteLength}`)),t(e.key.buffer)}))}_deserializePublicKey(e){return new Promise(((t,i)=>{e.byteLength!==this.publicKeySize&&i(new Error(`Invalid key length: ${e.byteLength}`)),t(new Q(this.name,new Uint8Array(e),"public"))}))}_serializePrivateKey(e){return new Promise(((t,i)=>{"private"!==e.type&&i(new Error("Not private key")),e.algorithm.name!==this.name&&i(new Error(`Invalid algorithm name: ${e.algorithm.name}`)),e.key.byteLength!==this.privateKeySize&&i(new Error(`Invalid key length: ${e.key.byteLength}`)),t(e.key.buffer)}))}_deserializePrivateKey(e){return new Promise(((t,i)=>{e.byteLength!==this.privateKeySize&&i(new Error(`Invalid key length: ${e.byteLength}`)),t(new Q(this.name,new Uint8Array(e),"private",["deriveBits"]))}))}}const ee=new Uint8Array([72,80,75,69,45,118,49]);class te extends w{constructor(){super(),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:m.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:x}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}init(e){this._suiteId=e}buildLabeledIkm(e,t){this._checkInit();const i=new Uint8Array(7+this._suiteId.byteLength+e.byteLength+t.byteLength);return i.set(ee,0),i.set(this._suiteId,7),i.set(e,7+this._suiteId.byteLength),i.set(t,7+this._suiteId.byteLength+e.byteLength),i}buildLabeledInfo(e,t,i){this._checkInit();const r=new Uint8Array(9+this._suiteId.byteLength+e.byteLength+t.byteLength);return r.set(new Uint8Array([0,i]),0),r.set(ee,2),r.set(this._suiteId,9),r.set(e,9+this._suiteId.byteLength),r.set(t,9+this._suiteId.byteLength+e.byteLength),r}async extract(e,i){if(await this._setup(),0===e.byteLength&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)throw new t("The salt length must be the same as the hashSize");const r=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",r,i)}async expand(e,t,i){await this._setup();const r=await this._api.importKey("raw",e,this.algHash,!1,["sign"]),n=new ArrayBuffer(i),a=new Uint8Array(n);let s=x;const l=new Uint8Array(t),c=new Uint8Array(1);if(i>255*this.hashSize)throw new Error("Entropy limit reached");const o=new Uint8Array(this.hashSize+l.length+1);for(let e=1,t=0;t<a.length;e++)c[0]=e,o.set(s,0),o.set(l,s.length),o.set(c,s.length+l.length),s=new Uint8Array(await this._api.sign("HMAC",r,o.slice(0,s.length+l.length+1))),a.length-t>=s.length?(a.set(s,t),t+=s.length):(a.set(s.slice(0,a.length-t),t),t+=a.length-t);return n}async extractAndExpand(e,t,i,r){await this._setup();const n=await this._api.importKey("raw",t,"HKDF",!1,["deriveBits"]);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:e,info:i},n,8*r)}async labeledExtract(e,t,i){return await this.extract(e,this.buildLabeledIkm(t,i).buffer)}async labeledExpand(e,t,i,r){return await this.expand(e,this.buildLabeledInfo(t,i,r).buffer,r)}_checkInit(){if(this._suiteId===x)throw new Error("Not initialized. Call init()")}}class ie extends te{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:m.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}}class re extends te{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:m.HkdfSha384}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-384",length:384}})}}class ne extends te{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:m.HkdfSha512}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-512",length:512}})}}const ae=["encrypt","decrypt"],se=BigInt(0);function le(e,t,i=""){const r=(n=e)instanceof Uint8Array||ArrayBuffer.isView(n)&&"Uint8Array"===n.constructor.name;var n;const a=e?.length,s=void 0!==t;if(!r||s&&a!==t){throw new Error((i&&`"${i}" `)+"expected Uint8Array"+(s?` of length ${t}`:"")+", got "+(r?`length=${a}`:"type="+typeof e))}return e}function ce(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function oe(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function he(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function ue(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function be(e,t){return e<<32-t|e>>>t}const fe=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),de=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));const ye=48,we=57,pe=65,ge=70,me=97,ve=102;function Pe(e){return e>=ye&&e<=we?e-ye:e>=pe&&e<=ge?e-(pe-10):e>=me&&e<=ve?e-(me-10):void 0}function _e(e){return function(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?se:BigInt("0x"+e)}(function(e){if(le(e),fe)return e.toHex();let t="";for(let i=0;i<e.length;i++)t+=de[e[i]];return t}(xe(le(e)).reverse()))}function Ke(e,t){oe(t);const i=function(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(fe)return Uint8Array.fromHex(e);const t=e.length,i=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(i);for(let t=0,n=0;t<i;t++,n+=2){const i=Pe(e.charCodeAt(n)),a=Pe(e.charCodeAt(n+1));if(void 0===i||void 0===a){const t=e[n]+e[n+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+n)}r[t]=16*i+a}return r}((e=function(e){if("bigint"==typeof e){if(!Ae(e))throw new Error("positive bigint expected, got "+e)}else oe(e);return e}(e)).toString(16).padStart(2*t,"0"));if(i.length!==t)throw new Error("number too large");return i}function xe(e){return Uint8Array.from(e)}const Ae=e=>"bigint"==typeof e&&se<=e;function ke(e,t,i,r){if(!function(e,t,i){return Ae(e)&&Ae(t)&&Ae(i)&&t<=e&&e<i}(t,i,r))throw new Error("expected valid "+e+": "+i+" <= n < "+r+", got "+t)}function je(e,t={},i={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");const r=(t,i)=>Object.entries(t).forEach((([t,r])=>function(t,i,r){const n=e[t];if(r&&void 0===n)return;const a=typeof n;if(a!==i||null===n)throw new Error(`param "${t}" is invalid: expected ${i}, got ${a}`)}(t,r,i)));r(t,!1),r(i,!0)}function Oe(e,t={}){const i=(t,i)=>e(i).update(t).digest(),r=e(void 0);return i.outputLen=r.outputLen,i.blockLen=r.blockLen,i.create=t=>e(t),Object.assign(i,t),Object.freeze(i)}async function Ue(e=32){const t=await L(),i=new Uint8Array(e);return t.getRandomValues(i),i}const He=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});class ze{constructor(e,t){if(Object.defineProperty(this,"oHash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"iHash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finished",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"destroyed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash must wrapped by utils.createHasher");oe(e.outputLen),oe(e.blockLen)}(e),le(t,void 0,"key"),this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,r=new Uint8Array(i);r.set(t.length>i?e.create().update(t).digest():t);for(let e=0;e<r.length;e++)r[e]^=54;this.iHash.update(r),this.oHash=e.create();for(let e=0;e<r.length;e++)r[e]^=106;this.oHash.update(r),he(r)}update(e){return ce(this),this.iHash.update(e),this}digestInto(e){ce(this),le(e,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||=Object.create(Object.getPrototypeOf(this),{});const{oHash:t,iHash:i,finished:r,destroyed:n,blockLen:a,outputLen:s}=this;return e.finished=r,e.destroyed=n,e.blockLen=a,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Ee=(e,t,i)=>new ze(e,t).update(i).digest();function Se(e,t,i){return e&t^e&i^t&i}Ee.create=(e,t)=>new ze(e,t);class Ie{constructor(e,t,i,r){Object.defineProperty(this,"blockLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"padOffset",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isLE",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"finished",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"length",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pos",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"destroyed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.blockLen=e,this.outputLen=t,this.padOffset=i,this.isLE=r,this.buffer=new Uint8Array(e),this.view=ue(this.buffer)}update(e){ce(this),le(e);const{view:t,buffer:i,blockLen:r}=this,n=e.length;for(let a=0;a<n;){const s=Math.min(r-this.pos,n-a);if(s!==r)i.set(e.subarray(a,a+s),this.pos),this.pos+=s,a+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=ue(e);for(;r<=n-a;a+=r)this.process(t,a)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){ce(this),function(e,t){le(e,void 0,"digestInto() output");const i=t.outputLen;if(e.length<i)throw new Error('"digestInto() output" expected to be of length >='+i)}(e,this),this.finished=!0;const{buffer:t,view:i,blockLen:r,isLE:n}=this;let{pos:a}=this;t[a++]=128,he(this.buffer.subarray(a)),this.padOffset>r-a&&(this.process(i,0),a=0);for(let e=a;e<r;e++)t[e]=0;i.setBigUint64(r-8,BigInt(8*this.length),n),this.process(i,0);const s=ue(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const c=l/4,o=this.get();if(c>o.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,o[e],n)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const i=e.slice(0,t);return this.destroy(),i}_cloneInto(e){e||=new this.constructor,e.set(...this.get());const{blockLen:t,buffer:i,length:r,finished:n,destroyed:a,pos:s}=this;return e.destroyed=a,e.finished=n,e.length=r,e.pos=s,r%t&&e.buffer.set(i),e}clone(){return this._cloneInto()}}const Le=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Be=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Ce=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),De=BigInt(2**32-1),Fe=BigInt(32);function Ge(e,t=!1){return t?{h:Number(e&De),l:Number(e>>Fe&De)}:{h:0|Number(e>>Fe&De),l:0|Number(e&De)}}const Te=(e,t,i)=>e>>>i,$e=(e,t,i)=>e<<32-i|t>>>i,Me=(e,t,i)=>e>>>i|t<<32-i,Ne=(e,t,i)=>e<<32-i|t>>>i,Re=(e,t,i)=>e<<64-i|t>>>i-32,Xe=(e,t,i)=>e>>>i-32|t<<64-i;function We(e,t,i,r){const n=(t>>>0)+(r>>>0);return{h:e+i+(n/2**32|0)|0,l:0|n}}const Ve=(e,t,i)=>(e>>>0)+(t>>>0)+(i>>>0),Je=(e,t,i,r)=>t+i+r+(e/2**32|0)|0,Ze=(e,t,i,r)=>(e>>>0)+(t>>>0)+(i>>>0)+(r>>>0),qe=(e,t,i,r,n)=>t+i+r+n+(e/2**32|0)|0,Qe=(e,t,i,r,n)=>(e>>>0)+(t>>>0)+(i>>>0)+(r>>>0)+(n>>>0),Ye=(e,t,i,r,n,a)=>t+i+r+n+a+(e/2**32|0)|0,et=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),tt=new Uint32Array(64);class it extends Ie{constructor(e){super(64,e,8,!1)}get(){const{A:e,B:t,C:i,D:r,E:n,F:a,G:s,H:l}=this;return[e,t,i,r,n,a,s,l]}set(e,t,i,r,n,a,s,l){this.A=0|e,this.B=0|t,this.C=0|i,this.D=0|r,this.E=0|n,this.F=0|a,this.G=0|s,this.H=0|l}process(e,t){for(let i=0;i<16;i++,t+=4)tt[i]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=tt[e-15],i=tt[e-2],r=be(t,7)^be(t,18)^t>>>3,n=be(i,17)^be(i,19)^i>>>10;tt[e]=n+tt[e-7]+r+tt[e-16]|0}let{A:i,B:r,C:n,D:a,E:s,F:l,G:c,H:o}=this;for(let e=0;e<64;e++){const t=o+(be(s,6)^be(s,11)^be(s,25))+((h=s)&l^~h&c)+et[e]+tt[e]|0,u=(be(i,2)^be(i,13)^be(i,22))+Se(i,r,n)|0;o=c,c=l,l=s,s=a+t|0,a=n,n=r,r=i,i=t+u|0}var h;i=i+this.A|0,r=r+this.B|0,n=n+this.C|0,a=a+this.D|0,s=s+this.E|0,l=l+this.F|0,c=c+this.G|0,o=o+this.H|0,this.set(i,r,n,a,s,l,c,o)}roundClean(){he(tt)}destroy(){this.set(0,0,0,0,0,0,0,0),he(this.buffer)}}class rt extends it{constructor(){super(32),Object.defineProperty(this,"A",{enumerable:!0,configurable:!0,writable:!0,value:0|Le[0]}),Object.defineProperty(this,"B",{enumerable:!0,configurable:!0,writable:!0,value:0|Le[1]}),Object.defineProperty(this,"C",{enumerable:!0,configurable:!0,writable:!0,value:0|Le[2]}),Object.defineProperty(this,"D",{enumerable:!0,configurable:!0,writable:!0,value:0|Le[3]}),Object.defineProperty(this,"E",{enumerable:!0,configurable:!0,writable:!0,value:0|Le[4]}),Object.defineProperty(this,"F",{enumerable:!0,configurable:!0,writable:!0,value:0|Le[5]}),Object.defineProperty(this,"G",{enumerable:!0,configurable:!0,writable:!0,value:0|Le[6]}),Object.defineProperty(this,"H",{enumerable:!0,configurable:!0,writable:!0,value:0|Le[7]})}}const nt=(()=>function(e,t=!1){const i=e.length,r=new Uint32Array(i),n=new Uint32Array(i);for(let a=0;a<i;a++){const{h:i,l:s}=Ge(e[a],t);[r[a],n[a]]=[i,s]}return[r,n]}(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),at=(()=>nt[0])(),st=(()=>nt[1])(),lt=new Uint32Array(80),ct=new Uint32Array(80);class ot extends Ie{constructor(e){super(128,e,16,!1)}get(){const{Ah:e,Al:t,Bh:i,Bl:r,Ch:n,Cl:a,Dh:s,Dl:l,Eh:c,El:o,Fh:h,Fl:u,Gh:b,Gl:f,Hh:d,Hl:y}=this;return[e,t,i,r,n,a,s,l,c,o,h,u,b,f,d,y]}set(e,t,i,r,n,a,s,l,c,o,h,u,b,f,d,y){this.Ah=0|e,this.Al=0|t,this.Bh=0|i,this.Bl=0|r,this.Ch=0|n,this.Cl=0|a,this.Dh=0|s,this.Dl=0|l,this.Eh=0|c,this.El=0|o,this.Fh=0|h,this.Fl=0|u,this.Gh=0|b,this.Gl=0|f,this.Hh=0|d,this.Hl=0|y}process(e,t){for(let i=0;i<16;i++,t+=4)lt[i]=e.getUint32(t),ct[i]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|lt[e-15],i=0|ct[e-15],r=Me(t,i,1)^Me(t,i,8)^Te(t,0,7),n=Ne(t,i,1)^Ne(t,i,8)^$e(t,i,7),a=0|lt[e-2],s=0|ct[e-2],l=Me(a,s,19)^Re(a,s,61)^Te(a,0,6),c=Ne(a,s,19)^Xe(a,s,61)^$e(a,s,6),o=Ze(n,c,ct[e-7],ct[e-16]),h=qe(o,r,l,lt[e-7],lt[e-16]);lt[e]=0|h,ct[e]=0|o}let{Ah:i,Al:r,Bh:n,Bl:a,Ch:s,Cl:l,Dh:c,Dl:o,Eh:h,El:u,Fh:b,Fl:f,Gh:d,Gl:y,Hh:w,Hl:p}=this;for(let e=0;e<80;e++){const t=Me(h,u,14)^Me(h,u,18)^Re(h,u,41),g=Ne(h,u,14)^Ne(h,u,18)^Xe(h,u,41),m=h&b^~h&d,v=Qe(p,g,u&f^~u&y,st[e],ct[e]),P=Ye(v,w,t,m,at[e],lt[e]),_=0|v,K=Me(i,r,28)^Re(i,r,34)^Re(i,r,39),x=Ne(i,r,28)^Xe(i,r,34)^Xe(i,r,39),A=i&n^i&s^n&s,k=r&a^r&l^a&l;w=0|d,p=0|y,d=0|b,y=0|f,b=0|h,f=0|u,({h:h,l:u}=We(0|c,0|o,0|P,0|_)),c=0|s,o=0|l,s=0|n,l=0|a,n=0|i,a=0|r;const j=Ve(_,x,k);i=Je(j,P,K,A),r=0|j}({h:i,l:r}=We(0|this.Ah,0|this.Al,0|i,0|r)),({h:n,l:a}=We(0|this.Bh,0|this.Bl,0|n,0|a)),({h:s,l:l}=We(0|this.Ch,0|this.Cl,0|s,0|l)),({h:c,l:o}=We(0|this.Dh,0|this.Dl,0|c,0|o)),({h:h,l:u}=We(0|this.Eh,0|this.El,0|h,0|u)),({h:b,l:f}=We(0|this.Fh,0|this.Fl,0|b,0|f)),({h:d,l:y}=We(0|this.Gh,0|this.Gl,0|d,0|y)),({h:w,l:p}=We(0|this.Hh,0|this.Hl,0|w,0|p)),this.set(i,r,n,a,s,l,c,o,h,u,b,f,d,y,w,p)}roundClean(){he(lt,ct)}destroy(){he(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class ht extends ot{constructor(){super(64),Object.defineProperty(this,"Ah",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[0]}),Object.defineProperty(this,"Al",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[1]}),Object.defineProperty(this,"Bh",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[2]}),Object.defineProperty(this,"Bl",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[3]}),Object.defineProperty(this,"Ch",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[4]}),Object.defineProperty(this,"Cl",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[5]}),Object.defineProperty(this,"Dh",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[6]}),Object.defineProperty(this,"Dl",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[7]}),Object.defineProperty(this,"Eh",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[8]}),Object.defineProperty(this,"El",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[9]}),Object.defineProperty(this,"Fh",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[10]}),Object.defineProperty(this,"Fl",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[11]}),Object.defineProperty(this,"Gh",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[12]}),Object.defineProperty(this,"Gl",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[13]}),Object.defineProperty(this,"Hh",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[14]}),Object.defineProperty(this,"Hl",{enumerable:!0,configurable:!0,writable:!0,value:0|Ce[15]})}}class ut extends ot{constructor(){super(48),Object.defineProperty(this,"Ah",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[0]}),Object.defineProperty(this,"Al",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[1]}),Object.defineProperty(this,"Bh",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[2]}),Object.defineProperty(this,"Bl",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[3]}),Object.defineProperty(this,"Ch",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[4]}),Object.defineProperty(this,"Cl",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[5]}),Object.defineProperty(this,"Dh",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[6]}),Object.defineProperty(this,"Dl",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[7]}),Object.defineProperty(this,"Eh",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[8]}),Object.defineProperty(this,"El",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[9]}),Object.defineProperty(this,"Fh",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[10]}),Object.defineProperty(this,"Fl",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[11]}),Object.defineProperty(this,"Gh",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[12]}),Object.defineProperty(this,"Gl",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[13]}),Object.defineProperty(this,"Hh",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[14]}),Object.defineProperty(this,"Hl",{enumerable:!0,configurable:!0,writable:!0,value:0|Be[15]})}}const bt=Oe((()=>new rt),He(1)),ft=Oe((()=>new ht),He(3)),dt=Oe((()=>new ut),He(2)),yt=BigInt(0);function wt(e,t){const i=e%t;return i>=yt?i:t+i}function pt(e,t,i){let r=e;for(;t-- >yt;)r*=r,r%=i;return r}function gt(e,t){return function(i){const r=e(i);return{secretKey:r,publicKey:t(r)}}}const mt=BigInt(0),vt=BigInt(1),Pt=BigInt(2);function _t(e){const t=(je(i=e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...i}));var i;const{P:r,type:n,adjustScalarBytes:a,powPminus2:s,randomBytes:l}=t,c="x25519"===n;if(!c&&"x448"!==n)throw new Error("invalid type");const o=l||Ue,h=c?255:448,u=c?32:56,b=c?BigInt(9):BigInt(5),f=c?BigInt(121665):BigInt(39081),d=c?Pt**BigInt(254):Pt**BigInt(447),y=c?BigInt(8)*Pt**BigInt(251)-vt:BigInt(4)*Pt**BigInt(445)-vt,w=d+y+vt,p=e=>wt(e,r),g=m(b);function m(e){return Ke(p(e),u).reverse()}function v(e,t){const i=function(e,t){ke("u",e,mt,r),ke("scalar",t,d,w);const i=t,n=e;let a=vt,l=mt,c=e,o=vt,u=mt;for(let e=BigInt(h-1);e>=mt;e--){const t=i>>e&vt;u^=t,({x_2:a,x_3:c}=x(u,a,c)),({x_2:l,x_3:o}=x(u,l,o)),u=t;const r=a+l,s=p(r*r),h=a-l,b=p(h*h),d=s-b,y=c+o,w=p((c-o)*r),g=p(y*h),m=w+g,v=w-g;c=p(m*m),o=p(n*p(v*v)),a=p(s*b),l=p(d*(s+p(f*d)))}({x_2:a,x_3:c}=x(u,a,c)),({x_2:l,x_3:o}=x(u,l,o));const b=s(l);return p(a*b)}(function(e){const t=xe(le(e,u,"uCoordinate"));return c&&(t[31]&=127),p(_e(t))}(t),function(e){return _e(a(xe(le(e,u,"scalar"))))}(e));if(i===mt)throw new Error("invalid private or public key received");return m(i)}function P(e){return v(e,g)}const _=P,K=v;function x(e,t,i){const r=p(e*(t-i));return{x_2:t=p(t-r),x_3:i=p(i+r)}}const A={secretKey:u,publicKey:u,seed:u},k=async e=>(void 0===e&&(e=await o(u)),le(e,A.seed,"seed"),e),j={randomSecretKey:k};return Object.freeze({keygen:gt(k,_),getSharedSecret:K,getPublicKey:_,scalarMult:v,scalarMultBase:P,utils:j,GuBytes:g.slice(),lengths:A})}export{ae as AEAD_USAGES,v as AeadId,s as DecapError,u as DeriveKeyPairError,n as DeserializeError,F as Dhkem,x as EMPTY,q as Ec,a as EncapError,l as ExportError,ie as HkdfSha256Native,re as HkdfSha384Native,ne as HkdfSha512Native,e as HpkeError,Y as Hybridkem,_ as INFO_LENGTH_LIMIT,P as INPUT_LENGTH_LIMIT,t as InvalidParamError,G as KEM_USAGES,m as KdfId,g as KemId,T as LABEL_DKP_PRK,$ as LABEL_SK,K as MINIMUM_PSK_LENGTH,h as MessageLimitReachedError,p as Mode,w as NativeAlgorithm,b as NotSupportedError,o as OpenError,A as SUITE_ID_HEADER_KEM,c as SealError,r as SerializeError,i as ValidationError,Q as XCryptoKey,z as base64UrlToBytes,H as concat,E as hexToBytes,Ee as hmac,U as i2Osp,O as isCryptoKeyPair,j as isDeno,k as isDenoV1,S as kemToKeyGenAlgorithm,L as loadCrypto,I as loadSubtleCrypto,wt as mod,_t as montgomery,pt as pow2,bt as sha256,dt as sha384,ft as sha512,B as xor};export default null;
//# sourceMappingURL=/sm/68b8a31fb7aa3e759c7a25712214ca2d8dafd9970f6d2a460e0d31074a104cc8.map